# ES 比Mysql快吗

es比mysql快是有场景的，mysql如果走了索引，在mysql索引量不是非常大的时候，是会比ES要更快，但是ES更加稳定，二且不管什么类型的的查询，都会走倒排索引，可能有一些涉及到模糊查询，精准匹配会额外小慢一点，但差别不大；

# ES中的一些概念

- es是面向文档的，文档在非关系数据库中是以json格式化形式存在的，而不是别的格式化文件（xml,yml等）
- es是有多种数据类型的，但是es的底层是利用了lecene，它只有一种字符串和数字类型，而lecene的实现则是把数字也变成了字符串，通过把数值进行转换成前缀匹配的形式进行排序也作为字符串插入到倒排词典中；
- es 的使用原则和单独使用lecene是很像的，lecene可以选择字段不报错只做索引，而es会全部保存，lenece和es都可以选择是否对该字段建立索引；
- es是通过自己的处理，把支持的json转换成了扁平化的只有kv结构的lecene支持的类型；
- es的核心是用空间换时间；



# 什么在ES中文档的集合叫index（索引）

这其实是全文索引，就是根据一些数据（记录或者文档）集合中的一些信息，建立的一个index，而不是indexs，因为它把整个集合看作一个文本整体；mysql在myisam引擎下页支持全文索引；

所以这些文档集合，文档集合的字段都公用一个索引（倒排），一些操作文档基础都是建立在索引上的，mysql可以有多个索引，但是本体数据保存也是采用的聚集索引；所以它这么叫自己也是合适的，但还是不咋合适吧，这个名字起得不好，有点道理但是不多；

# 什么是倒排索引

**inverted index**：倒排索引，颠倒索引，他是从索引的结构上表达的索引，全文索引一般采用倒排索引，提取出term（词），就是字典目录中的词；词是从全部文档中提取出来的集合；作为一个索引序列；



# 什么是全文检索

**full-text search**：全文搜索是full-text database 的一个功能，全文数据库是整合了所有文本集合并组织了结构的数据库，全文搜索可以搜索每一个记录或者说文件中的文本数据；full-text 是一个形容词，表示一个完整的文本，详细的解释是，不管有多少记录和文本都看作一个完整的文本；文件指纹Index也是一个方案



# 为什么ES不会有索引失效，而mysql会有索引失效的情况

mysql会索引失效是因为同时存在多个不同类型的索引，而一次查询只能走一个索引，如果这个时候出现了需要别的列，那么是不能同时使用多个索引的，同时使用多个索引等于没使用索引同时查两个索引太复杂了更慢，es和lucene是只有一个倒排索引；而且字段没有加入索引是无法被搜索的；mysql中的索引都是值顺序排序的，字符串是根据字符值，联合索引必须满足最左匹配，只要出现，查询可能使用了多列，可能使用多个索引，破坏联合索引的最左匹配，破坏了联合索引的使用条件，字符串破坏了从左往右比较字符的顺序就破坏了字符索引的使用方法，order by 如果 后面跟的是索引列，可能也可以走索引，这样就打破了规则，可以执行多个执行，但其实是分批使用的；而ES就一个索引，全部的字段都通过倒排的方式建立成了倒排词典，利用这个词典做不同的额外处理就可以得到想要的数据；







